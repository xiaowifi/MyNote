+++
date = "2021-2-19"
title = "探索 Jetpack 库"
description = "探索 Jetpack 库"
series = ["顶呱呱"]
featured = true
+++
![](https://gitee.com/lalalaxiaowifi/pictures/raw/master/image/%E6%97%A5%E5%B8%B8%E6%90%AC%E7%A0%96%E5%A4%B4.png)
> 顺便推一下[博客主页](http://lalalaxiaowifi.gitee.io/pictures/) 
## 正文
> 网络请求相关。
### 数据回调
采用基于livedata的 LiveEventBus 进行数据传输回调更改。
### loading层控制
采用拦截器机制。
### 网络请求相关步骤
* 创建一个类A，继承于MvvmBaseViewModel。
* 为A创建一个view接口
* 为A 创建一个Request B，B继承于BaseModel 
* B 提供一个网络请求方法。提供给A调用，方法传参需要提供网络请求数据，和A的回调。
### B中的接口相关
* 创建模块接口 定义 接口请求返回参数和接口地址，传入参数等等。
````aidl
    //获取首页定位列表
    @GET("nk/home/get_city_list.do")
    Observable<BaseData<LocationCity>> getLocationCityList();
````
* 提供一个帮助类，提供一个静态方法，用于提供网络请求实体对象。
````aidl
 //获取登录api service
    public static HomeApi getHomeApi() {
        return RxHttpUtils.createApi("home", ConstantUrl.TEST_Home_URL, HomeApi.class);
    }
````
* 网络请求调用
````aidl
 HomeApiHelp
                .getHomeApi()
                .getHomeCommodityData(jsonData)
                .compose(Transformer.switchSchedulers())
                .subscribe(new BaseConsumer<List<HomeCommodityEntity>>() {
                    @Override
                    protected void onSuccess(List<HomeCommodityEntity> data) {
                        callBack.onSuccess(data);
                    }

                    @Override
                    public void onFail(BaseData<List<HomeCommodityEntity>> data) {

                    }
                }, new BaseErrorConsumer() {
                    @Override
                    public void onError(int code,String message) {
                    }
                }).isDisposed();
````
### 数据接收
````aidl
 LiveEventBus.get("getCommodityDataSuccess" + formatId).observe(this, commodityDataSuccess -> {
          
        });
````
